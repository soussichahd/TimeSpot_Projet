@page
@model MyAmazonstore3.Pages.AcceuilModel
@{
    ViewData["Title"] = "Accueil - MyAmazonStore";
}
@await Component.InvokeAsync("Header")

<div class="container">

    @if (TempData["Message"] != null)
    {
        <div class="alert alert-success">
            <i class="fas fa-check-circle"></i> @TempData["Message"]
        </div>
    }


    @if (!string.IsNullOrEmpty(Model.Search))
    {
        <div class="alert alert-info">
            <i class="fas fa-info-circle"></i>
            Résultats de recherche pour : <strong>@Model.Search</strong>
            (@Model.Produits.Count produit(s) trouvé(s))
            <a href="/Acceuil/Acceuil" style="margin-left: 15px; color: var(--primary-color);">
                <i class="fas fa-times"></i> Effacer
            </a>
        </div>
    }

    <!-- Liste des Produits -->
    <section class="products-section">
        <h2 class="section-title">
            @if (string.IsNullOrEmpty(Model.Search))
            {
                <span >Montres en vente </span>
            }
            else
            {
                <span>Résultats de recherche</span>
            }
        </h2>

        @if (Model.Produits.Any())
        {
            <div class="product-grid">
                @foreach (var produit in Model.Produits)
                {<div class="product-card">
                        @if (produit.Prix < 100)
                        {
                            <span class="badge badge-sale">Promo</span>
                        }
                        else if (produit.ProduitId <=6)
                        {
                            <span class="badge badge-new">Nouveau</span>
                        }
                       

                        <img src="@(string.IsNullOrEmpty(produit.ImageUrl) ? "https://via.placeholder.com/250x200?text=" + Uri.EscapeDataString(produit.Nom) : produit.ImageUrl)"
                             alt="@produit.Nom"
                             class="product-image">

                        <h3 class="product-title">@produit.Nom</h3>

                        @if (produit.Categorie != null)
                        {
                            <p style="font-size: 13px; color: var(--text-light); margin-bottom: 8px;">
                                <i class="fas fa-tag"></i> @produit.Categorie.Nom
                            </p>
                        }


                        @if (!string.IsNullOrEmpty(produit.Description))
                        {
                            <p style="font-size: 14px; color: var(--text-light); margin-bottom: 10px;
                                                  display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical;
                                                  overflow: hidden;">
                                @produit.Description
                            </p>
                        }

                        <div class="product-price">
                            <span class="price-currency">$</span>@produit.Prix.ToString("N2")
                        </div>

                        <form method="post" asp-page-handler="AjouterAuPanier">
                            <input type="hidden" name="produitId" value="@produit.ProduitId" />
                            <input type="hidden" name="quantite" value="1" />
                            <button type="submit" class="btn btn-primary" style="width: 100%;">
                                <i class="fas fa-cart-plus"></i> Ajouter au panier
                            </button>
                        </form>

                        <a asp-page="/Acceuil/DetailProduit"
                           asp-route-id="@produit.ProduitId" class="btn btn-primary" style="width: 100%;">
                            Voir détails
                        </a>


                    </div>
                }
            </div>
        }
        else
        {
            <div class="card" style="text-align: center; padding: 60px 20px;">
                <i class="fas fa-search" style="font-size: 64px; color: var(--border-color); margin-bottom: 20px;"></i>
                <h3 style="margin-bottom: 10px;">Aucun produit trouvé</h3>
                <p style="color: var(--text-light); margin-bottom: 20px;">
                    @if (!string.IsNullOrEmpty(Model.Search))
                    {
                        <span>Aucun produit ne correspond à votre recherche "<strong>@Model.Search</strong>"</span>
                    }
                    else
                    {
                        <span>La boutique ne contient aucun produit pour le moment.</span>
                    }
                </p>
                <a href="/Acceuil/Acceuil" class="btn btn-primary">
                    <i class="fas fa-home"></i> Retour à l'accueil
                </a>
            </div>
        }
    </section>

 
</div>
